var TcHmi;!function(i){var t,e,r,n;function o(t,e,n){var o=r.call(this,t,e,n)||this;return o.__locked=!1,o.__triggerUIFinishedOnBlur=!0,o.__objectResolvers=new Map,o.__onKeydown=function(t){!0===i.Access.checkAccess(o,"operate")&&!1!==o.getIsEnabled()&&(o.__triggerUIFinishedOnBlur=!0,"Escape"===t.key?(o.__setText(o.__oldText),i.EventProvider.raise(o.__id+".onUserInteractionCanceled"),o.__triggerUIFinishedOnBlur=!1,o.__autoFocusOut&&o.__elementInput.blur()):"Enter"!==t.key||o.__multiline||(o.__oldText=o.__text,o.__triggerUIFinishedOnBlur=!1,o.__autoFocusOut&&(o.__elementInput.blur(),o.__unlock()),i.EventProvider.raise(o.__id+".onUserInteractionFinished"),t.preventDefault()))},o.__onInput=function(t){!0===i.Access.checkAccess(o,"operate")&&!1!==o.getIsEnabled()&&(o.__triggerUIFinishedOnBlur=!0,o.__setText(o.__elementInput.val(),!1))},o.__onPaste=function(t){!0===i.System.Services.accessManager.checkAccess(o,"operate")&&!1!==o.getIsEnabled()&&(o.__triggerUIFinishedOnBlur=!0,window.setTimeout(function(){o.__setText(o.__elementInput.val(),!1)},1))},o.__onCut=function(t){!0===i.Access.checkAccess(o,"operate")&&!1!==o.getIsEnabled()&&(o.__triggerUIFinishedOnBlur=!0,window.setTimeout(function(){o.__setText(o.__elementInput.val(),!1)},1))},o.__onFocusIn=function(t){!0===i.Access.checkAccess(o,"operate")&&!1!==o.getIsEnabled()&&(o.__triggerUIFinishedOnBlur=!0,o.__oldText=o.__text,o.__elementFocusBorder[0].classList.add("tchmi-focus"),i.EventProvider.raise(o.__id+".onFocusIn",t),o.__lock())},o.__onFocusOut=function(t){!0===i.Access.checkAccess(o,"operate")&&!1!==o.getIsEnabled()&&(o.__unlock(),o.__elementFocusBorder[0].classList.remove("tchmi-focus"),i.EventProvider.raise(o.__id+".onFocusOut",t),o.__oldText=o.__text,o.__triggerUIFinishedOnBlur&&i.EventProvider.raise(o.__id+".onUserInteractionFinished"),o.__triggerUIFinishedOnBlur=!0)},o.__onResolverForContentPaddingWatchCallback=function(t){!1===o.__isAttached&&t.destroy&&t.destroy(),tchmi_equal(t.value,o.__contentPadding)||(o.__contentPadding=t.value,i.EventProvider.raise(o.__id+".onFunctionResultChanged",["getContentPadding"]),o.__processContentPadding())},o.__onResolverForTextColorWatchCallback=function(t){!1===o.__isAttached&&t.destroy&&t.destroy(),tchmi_equal(t.value,o.__textColor)||(o.__textColor=t.value,i.EventProvider.raise(o.__id+".onFunctionResultChanged",["getTextColor"]),o.__processTextColor())},o}t=i.Controls||(i.Controls={}),e=t.Beckhoff||(t.Beckhoff={}),r=i.Controls.System.TcHmiControl,__extends(o,r),o.prototype.__previnit=function(){if(this.__elementTemplateRoot=this.__element.find(".tchmi-textbox-template"),this.__elementBorder=this.__elementTemplateRoot.find(".tchmi-textbox-template-border"),this.__elementContainer=this.__elementTemplateRoot.find(".tchmi-textbox-template-input-container"),this.__elementFocusBorder=this.__elementTemplateRoot.find(".tchmi-textbox-template-focus-border"),0===this.__elementTemplateRoot.length||0===this.__elementBorder.length||0===this.__elementContainer.length||0===this.__elementFocusBorder.length)throw new Error("Invalid Template.html");this.__elementInput=this.__elementTemplateRoot.find(".tchmi-textbox-template-input"),r.prototype.__previnit.call(this)},o.prototype.__init=function(){r.prototype.__init.call(this)},o.prototype.__attach=function(){r.prototype.__attach.call(this);var t=!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&{passive:!0,capture:!1},e=!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&{passive:!1,capture:!1};this.__elementTemplateRoot[0].addEventListener("focusin",this.__onFocusIn,t),this.__elementTemplateRoot[0].addEventListener("focusout",this.__onFocusOut,t),this.__elementContainer[0].addEventListener("keydown",this.__onKeydown,e),this.__elementContainer[0].addEventListener("input",this.__onInput,t),this.__elementContainer[0].addEventListener("paste",this.__onPaste,t),this.__elementContainer[0].addEventListener("cut",this.__onCut,t),this.__objectResolvers.forEach(function(t){return t.resolver.watch(t.watchCallback)})},o.prototype.__detach=function(){r.prototype.__detach.call(this);var t=!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&{passive:!0,capture:!1},e=!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&{passive:!1,capture:!1};this.__elementTemplateRoot[0].removeEventListener("focusin",this.__onFocusIn,t),this.__elementTemplateRoot[0].removeEventListener("focusout",this.__onFocusOut,t),this.__elementContainer[0].removeEventListener("keydown",this.__onKeydown,e),this.__elementContainer[0].removeEventListener("input",this.__onInput,t),this.__elementContainer[0].removeEventListener("paste",this.__onPaste,t),this.__elementContainer[0].removeEventListener("cut",this.__onCut,t),this.__objectResolvers.forEach(function(t){t.watchDestroyer&&(t.watchDestroyer(),t.watchDestroyer=null)})},o.prototype.destroy=function(){this.__objectResolvers.forEach(function(t){t.watchDestroyer&&t.watchDestroyer(),t.resolver.destroy()}),this.__objectResolvers.clear(),r.prototype.destroy.call(this)},o.prototype.setText=function(t){!0!==this.__locked&&this.__setText(t)},o.prototype.__setText=function(t,e){void 0===e&&(e=!0);var n=i.ValueConverter.toString(t);null===n&&(n=this.getAttributeDefaultValueInternal("Text")),n!==this.__text&&(this.__text=n,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getText"]),i.EventProvider.raise(this.__id+".onTextChanged",this.__text),e&&this.__processText())},o.prototype.getText=function(){return this.__text},o.prototype.__processText=function(){if(void 0!==this.__text&&null!==this.__text){var t=this.__text;this.__multiline||(t=this.__text.replace(/(?:\r\n|\r|\n)/g," ")),this.__elementInput.val(t)}},o.prototype.setTextHorizontalAlignment=function(t){var e=i.ValueConverter.toHorizontalAlignment(t);null===e&&(e=this.getAttributeDefaultValueInternal("TextHorizontalAlignment")),e!==this.__textHorizontalAlignment&&(this.__textHorizontalAlignment=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getTextHorizontalAlignment"]),this.__processTextHorizontalAlignment())},o.prototype.getTextHorizontalAlignment=function(){return this.__textHorizontalAlignment},o.prototype.__processTextHorizontalAlignment=function(){switch(this.__textHorizontalAlignment){case"Left":i.StyleProvider.setSimpleElementStyle(this.__elementContainer,"text-align","left");break;case"Center":i.StyleProvider.setSimpleElementStyle(this.__elementContainer,"text-align","center");break;case"Right":i.StyleProvider.setSimpleElementStyle(this.__elementContainer,"text-align","right");break;default:i.StyleProvider.setSimpleElementStyle(this.__elementContainer,"text-align",null)}},o.prototype.setContentPadding=function(t){var e=i.ValueConverter.toObject(t);null===e&&(e=this.getAttributeDefaultValueInternal("ContentPadding"));var n=this.__objectResolvers.get("contentPadding");n&&(n.watchDestroyer&&n.watchDestroyer(),n.resolver.destroy());var o=new i.Symbol.ObjectResolver(e);this.__objectResolvers.set("contentPadding",{resolver:o,watchCallback:this.__onResolverForContentPaddingWatchCallback,watchDestroyer:o.watch(this.__onResolverForContentPaddingWatchCallback)})},o.prototype.getContentPadding=function(){return this.__contentPadding},o.prototype.__processContentPadding=function(){i.StyleProvider.processContentPadding(this.__elementInput,this.__contentPadding)},o.prototype.setTextFontSize=function(t){var e=i.ValueConverter.toNumber(t);null===e&&(e=this.getAttributeDefaultValueInternal("TextFontSize")),e!==this.__textFontSize&&(this.__textFontSize=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getTextFontSize"]),this.__processTextFontSize())},o.prototype.getTextFontSize=function(){return this.__textFontSize},o.prototype.__processTextFontSize=function(){i.StyleProvider.processFontSize(this.__elementContainer,this.__textFontSize,this.__textFontSizeUnit)},o.prototype.setTextFontSizeUnit=function(t){var e=i.ValueConverter.toFontSizeUnit(t);null===e&&(e=this.getAttributeDefaultValueInternal("TextFontSizeUnit")),e!==this.__textFontSizeUnit&&(this.__textFontSizeUnit=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getTextFontSizeUnit"]),this.__processTextFontSizeUnit())},o.prototype.getTextFontSizeUnit=function(){return this.__textFontSizeUnit},o.prototype.__processTextFontSizeUnit=function(){i.StyleProvider.processFontSize(this.__elementContainer,this.__textFontSize,this.__textFontSizeUnit)},o.prototype.setTextFontFamily=function(t){var e=i.ValueConverter.toFontFamily(t);null===e&&(e=this.getAttributeDefaultValueInternal("TextFontFamily")),e!==this.__textFontFamily&&(this.__textFontFamily=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getTextFontFamily"]),this.__processTextFontFamily())},o.prototype.getTextFontFamily=function(){return this.__textFontFamily},o.prototype.__processTextFontFamily=function(){i.StyleProvider.processFontFamily(this.__elementContainer,this.__textFontFamily)},o.prototype.setTextFontStyle=function(t){var e=i.ValueConverter.toFontStyle(t);null===e&&(e=this.getAttributeDefaultValueInternal("TextFontStyle")),e!==this.__textFontStyle&&(this.__textFontStyle=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getTextFontStyle"]),this.__processTextFontStyle())},o.prototype.getTextFontStyle=function(){return this.__textFontStyle},o.prototype.__processTextFontStyle=function(){i.StyleProvider.processFontStyle(this.__elementContainer,this.__textFontStyle)},o.prototype.setTextFontWeight=function(t){var e=i.ValueConverter.toFontWeight(t);null===e&&(e=this.getAttributeDefaultValueInternal("TextFontWeight")),e!==this.__textFontWeight&&(this.__textFontWeight=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getTextFontWeight"]),this.__processTextFontWeight())},o.prototype.getTextFontWeight=function(){return this.__textFontWeight},o.prototype.__processTextFontWeight=function(){i.StyleProvider.processFontWeight(this.__elementContainer,this.__textFontWeight)},o.prototype.setMultiline=function(t){var e=i.ValueConverter.toBoolean(t);null===e&&(e=this.getAttributeDefaultValueInternal("Multiline")),e!==this.__multiline&&(this.__multiline=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getMultiline"]),this.__processMultiline())},o.prototype.getMultiline=function(){return this.__multiline},o.prototype.__processMultiline=function(){if(!0===this.__multiline){if(void 0===this.__elementInput[0]||"TEXTAREA"!==this.__elementInput[0].tagName){var t=this.__elementInput;this.__elementInput=$('<textarea class="tchmi-textbox-template-input" wrap="off" spellcheck="false"></textarea>'),this.__processWordWrap(),this.__processText(),this.__processContentPadding(),this.__processPlaceholder(),t.length?t.replaceWith(this.__elementInput):this.__elementContainer.append(this.__elementInput)}}else void 0!==this.__elementInput[0]&&"INPUT"===this.__elementInput[0].tagName||(t=this.__elementInput,this.__elementInput=$('<input class="tchmi-textbox-template-input" spellcheck="false" />'),this.__processWordWrap(),this.__processText(),this.__processContentPadding(),this.__processPlaceholder(),t.length?t.replaceWith(this.__elementInput):this.__elementContainer.append(this.__elementInput))},o.prototype.setWordWrap=function(t){var e=i.ValueConverter.toBoolean(t);null===e&&(e=this.getAttributeDefaultValueInternal("WordWrap")),e!==this.__wordWrap&&(this.__wordWrap=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getWordWrap"]),this.__processWordWrap())},o.prototype.getWordWrap=function(){return this.__wordWrap},o.prototype.__processWordWrap=function(){this.__wordWrap?(i.StyleProvider.setSimpleElementStyle(this.__elementInput,{"white-space":"pre-wrap","word-wrap":"break-word","overflow-wrap":"break-word"}),this.__elementInput.attr("wrap","on")):(i.StyleProvider.setSimpleElementStyle(this.__elementInput,{"white-space":null,"word-wrap":null,"overflow-wrap":null}),this.__elementInput.attr("wrap","off"))},o.prototype.setPlaceholder=function(t){var e=i.ValueConverter.toString(t);null===e&&(e=this.getAttributeDefaultValueInternal("Placeholder")),e!==this.__placeholder&&(this.__placeholder=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getPlaceholder"]),this.__processPlaceholder())},o.prototype.getPlaceholder=function(){return this.__placeholder},o.prototype.__processPlaceholder=function(){this.__placeholder?this.__elementInput.attr("placeholder",this.__placeholder):this.__elementInput.attr("placeholder","")},o.prototype.setTextColor=function(t){var e=i.ValueConverter.toObject(t);null===e&&(e=this.getAttributeDefaultValueInternal("TextColor"));var n=this.__objectResolvers.get("textColor");n&&(n.watchDestroyer&&n.watchDestroyer(),n.resolver.destroy());var o=new i.Symbol.ObjectResolver(e);this.__objectResolvers.set("textColor",{resolver:o,watchCallback:this.__onResolverForTextColorWatchCallback,watchDestroyer:o.watch(this.__onResolverForTextColorWatchCallback)})},o.prototype.getTextColor=function(){return this.__textColor},o.prototype.__processTextColor=function(){i.StyleProvider.processTextColor(this.__elementContainer,this.__textColor)},o.prototype.setAutoFocusOut=function(t){var e=i.ValueConverter.toBoolean(t);null===e&&(e=this.getAttributeDefaultValueInternal("AutoFocusOut")),e!==this.__autoFocusOut&&(this.__autoFocusOut=e,i.EventProvider.raise(this.__id+".onFunctionResultChanged",["getAutoFocusOut"]),this.__processAutoFocusOut())},o.prototype.getAutoFocusOut=function(){return this.__autoFocusOut},o.prototype.__processAutoFocusOut=function(){},o.prototype.__lock=function(){this.__locked=!0},o.prototype.__unlock=function(){this.__locked=!1},o.prototype.__processControlActivation=function(){var t=this.__elementInput[0];t&&(i.System.Services.accessManager.checkAccess(this,"operate")&&this.getIsEnabled()?t.disabled=!1:(t.blur(),t.disabled=!0))},o.prototype.__processIsEnabled=function(){r.prototype.__processIsEnabled.call(this),this.__processControlActivation()},o.prototype.__processAccessConfig=function(){r.prototype.__processAccessConfig.call(this),this.__processControlActivation()},n=o,e.TcHmiTextbox=n,t.register("tchmi-textbox",i.Controls.Beckhoff.TcHmiTextbox,"Beckhoff/TcHmiTextbox/","Beckhoff/TcHmiTextbox/Template.html")}(TcHmi=TcHmi||{});