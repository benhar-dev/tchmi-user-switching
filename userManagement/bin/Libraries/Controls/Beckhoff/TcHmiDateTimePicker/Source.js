var TcHmi;!function(w){var e,t,_,n;function i(e,t,n){var i=_.call(this,e,t,n)||this;return i.__onMousedownHourUpDestroyEvent=null,i.__onMousedownHourDownDestroyEvent=null,i.__onMousedownMinuteUpDestroyEvent=null,i.__onMousedownMinuteDownDestroyEvent=null,i.__onMousedownSecondUpDestroyEvent=null,i.__onMousedownSecondDownDestroyEvent=null,i.__onMousedownMillisecondUpDestroyEvent=null,i.__onMousedownMillisecondDownDestroyEvent=null,i.__onPressedOkDestroyEvent=null,i.__onPressedCancelDestroyEvent=null,i.__onTextChangedHourDestroyEvent=null,i.__onTextChangedMinuteDestroyEvent=null,i.__onTextChangedSecondDestroyEvent=null,i.__onTextChangedMillisecondDestroyEvent=null,i.__onUserInteractionFinishedHourDestroyEvent=null,i.__onUserInteractionFinishedMinuteDestroyEvent=null,i.__onUserInteractionFinishedSecondDestroyEvent=null,i.__onUserInteractionFinishedMillisecondDestroyEvent=null,i.__baseControls={},i.__monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],i.__internalDateObject={year:0,month:0,day:0,hour:0,minute:0,second:0,millisecond:0},i.__isPressedTimeButtons=!1,i.__intervalTimerTimeButtons=null,i.__isPressedCalendar=!1,i.__intervalTimerCalendar=0,i.__utcOffset=0,i.__mousedownHandler=i.__onMousedown(),i.__mousedownCalendarHandler=i.__onMousedownCalendar(),i.__mouseupHandler=i.__onMouseup(),i}e=w.Controls||(w.Controls={}),t=e.Beckhoff||(e.Beckhoff={}),_=w.Controls.System.TcHmiControl,__extends(i,_),i.prototype.__previnit=function(){this.__elementDTPTemplate=$('<div class="tchmi-date-time-picker-template-overlay tchmi-box"></div>');var e=$('<div class="tchmi-date-time-picker-selected-area-template tchmi-box"></div>'),t=w.ControlFactory.createEx("tchmi-textblock",this.__id+"_dateValue",{"data-tchmi-text-horizontal-alignment":"Center","data-tchmi-text-vertical-alignment":"Center","data-tchmi-text-font-size":15,"data-tchmi-text":"01. Januar 1970, 00:00:00:000"},this);if(void 0===t)throw new Error("Needed Textblock could not be instantiated");t.getElement().addClass("tchmi-date-time-picker-template-value"),this.__baseControls[this.__id+"_dateValue"]=t,e.append(t.getElement()[0]);var n=$('<div class="tchmi-date-time-picker-choice-area-template"></div>');this.__elementCalendarTemplate=$('<div class="tchmi-date-time-picker-calendar-template tchmi-box"></div>'),this.__elementCalendarTemplate.append(this.createCalendar(1970,1,1));var i=$('<div class="tchmi-date-time-picker-time-and-button-area-template"></div>'),a=$('<div class="tchmi-date-time-picker-time-area-template tchmi-box"></div>');a.append(this.createTime(0,0,0,0)),i.append(a);var o=$('<div class="tchmi-date-time-picker-button-area-template tchmi-box"></div>'),r=$('<div class="tchmi-date-time-picker-button-template"></div>'),s=w.ControlFactory.createEx("tchmi-button",this.__id+"_cancelButton",{"data-tchmi-text":"Cancel"},this);if(void 0===s)throw new Error("Needed Button could not be instantiated");s.getElement().addClass("tchmi-date-time-picker-template-action-button"),r.append(s.getElement()[0]),this.__baseControls[this.__id+"_cancelButton"]=s;var l=w.ControlFactory.createEx("tchmi-button",this.__id+"_okButton",{"data-tchmi-text":"Ok"},this);if(void 0===l)throw new Error("Needed Button could not be instantiated");l.getElement().addClass("tchmi-date-time-picker-template-action-button"),r.append(l.getElement()[0]),(this.__baseControls[this.__id+"_okButton"]=l).setText("Ok"),o.append(r),i.append(o),n.append(this.__elementCalendarTemplate),n.append(i),this.__elementDTPTemplate.append(e),this.__elementDTPTemplate.append(n),_.prototype.__previnit.call(this)},i.prototype.__init=function(){_.prototype.__init.call(this)},i.prototype.__attach=function(){_.prototype.__attach.call(this);var e={passive:!0,capture:!1};this.__element[0].addEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&e),this.__elementCalendarTemplate[0].addEventListener("mousedown",this.__mousedownCalendarHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&e),document.addEventListener("mouseup",this.__mouseupHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&e),this.__onMousedownHourUpDestroyEvent=w.EventProvider.register(this.__id+"_hourUpButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onMousedownHourDownDestroyEvent=w.EventProvider.register(this.__id+"_hourDownButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onMousedownMinuteUpDestroyEvent=w.EventProvider.register(this.__id+"_minuteUpButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onMousedownMinuteDownDestroyEvent=w.EventProvider.register(this.__id+"_minuteDownButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onMousedownSecondUpDestroyEvent=w.EventProvider.register(this.__id+"_secondUpButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onMousedownSecondDownDestroyEvent=w.EventProvider.register(this.__id+"_secondDownButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onMousedownMillisecondUpDestroyEvent=w.EventProvider.register(this.__id+"_millisecondUpButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onMousedownMillisecondDownDestroyEvent=w.EventProvider.register(this.__id+"_millisecondDownButton.onMouseDown",this.__onMousedownTimeButtons()),this.__onPressedOkDestroyEvent=w.EventProvider.register(this.__id+"_okButton.onPressed",this.__onPressed()),this.__onPressedCancelDestroyEvent=w.EventProvider.register(this.__id+"_cancelButton.onPressed",this.__onPressed()),this.__onTextChangedHourDestroyEvent=w.EventProvider.register(this.__id+"_hourValueTextbox.onTextChanged",this.__onTextChanged()),this.__onTextChangedMinuteDestroyEvent=w.EventProvider.register(this.__id+"_minuteValueTextbox.onTextChanged",this.__onTextChanged()),this.__onTextChangedSecondDestroyEvent=w.EventProvider.register(this.__id+"_secondValueTextbox.onTextChanged",this.__onTextChanged()),this.__onTextChangedMillisecondDestroyEvent=w.EventProvider.register(this.__id+"_millisecondValueTextbox.onTextChanged",this.__onTextChanged()),this.__onUserInteractionFinishedHourDestroyEvent=w.EventProvider.register(this.__id+"_hourValueTextbox.onUserInteractionFinished",this.__onUserInteractionFinished()),this.__onUserInteractionFinishedMinuteDestroyEvent=w.EventProvider.register(this.__id+"_minuteValueTextbox.onUserInteractionFinished",this.__onUserInteractionFinished()),this.__onUserInteractionFinishedSecondDestroyEvent=w.EventProvider.register(this.__id+"_secondValueTextbox.onUserInteractionFinished",this.__onUserInteractionFinished()),this.__onUserInteractionFinishedMillisecondDestroyEvent=w.EventProvider.register(this.__id+"_millisecondValueTextbox.onUserInteractionFinished",this.__onUserInteractionFinished())},i.prototype.__detach=function(){_.prototype.__detach.call(this),null!==this.__onMousedownHourUpDestroyEvent&&(this.__onMousedownHourUpDestroyEvent(),this.__onMousedownHourUpDestroyEvent=null),null!==this.__onMousedownHourDownDestroyEvent&&(this.__onMousedownHourDownDestroyEvent(),this.__onMousedownHourDownDestroyEvent=null),null!==this.__onMousedownMinuteUpDestroyEvent&&(this.__onMousedownMinuteUpDestroyEvent(),this.__onMousedownMinuteUpDestroyEvent=null),null!==this.__onMousedownMinuteDownDestroyEvent&&(this.__onMousedownMinuteDownDestroyEvent(),this.__onMousedownMinuteDownDestroyEvent=null),null!==this.__onMousedownSecondUpDestroyEvent&&(this.__onMousedownSecondUpDestroyEvent(),this.__onMousedownSecondUpDestroyEvent=null),null!==this.__onMousedownSecondDownDestroyEvent&&(this.__onMousedownSecondDownDestroyEvent(),this.__onMousedownSecondDownDestroyEvent=null),null!==this.__onMousedownMillisecondUpDestroyEvent&&(this.__onMousedownMillisecondUpDestroyEvent(),this.__onMousedownMillisecondUpDestroyEvent=null),null!==this.__onMousedownMillisecondDownDestroyEvent&&(this.__onMousedownMillisecondDownDestroyEvent(),this.__onMousedownMillisecondDownDestroyEvent=null),null!==this.__onPressedOkDestroyEvent&&(this.__onPressedOkDestroyEvent(),this.__onPressedOkDestroyEvent=null),null!==this.__onPressedCancelDestroyEvent&&(this.__onPressedCancelDestroyEvent(),this.__onPressedCancelDestroyEvent=null),null!==this.__onTextChangedHourDestroyEvent&&(this.__onTextChangedHourDestroyEvent(),this.__onTextChangedHourDestroyEvent=null),null!==this.__onTextChangedMinuteDestroyEvent&&(this.__onTextChangedMinuteDestroyEvent(),this.__onTextChangedMinuteDestroyEvent=null),null!==this.__onTextChangedSecondDestroyEvent&&(this.__onTextChangedSecondDestroyEvent(),this.__onTextChangedSecondDestroyEvent=null),null!==this.__onTextChangedMillisecondDestroyEvent&&(this.__onTextChangedMillisecondDestroyEvent(),this.__onTextChangedMillisecondDestroyEvent=null),null!==this.__onUserInteractionFinishedHourDestroyEvent&&(this.__onUserInteractionFinishedHourDestroyEvent(),this.__onUserInteractionFinishedHourDestroyEvent=null),null!==this.__onUserInteractionFinishedMinuteDestroyEvent&&(this.__onUserInteractionFinishedMinuteDestroyEvent(),this.__onUserInteractionFinishedMinuteDestroyEvent=null),null!==this.__onUserInteractionFinishedSecondDestroyEvent&&(this.__onUserInteractionFinishedSecondDestroyEvent(),this.__onUserInteractionFinishedSecondDestroyEvent=null),null!==this.__onUserInteractionFinishedMillisecondDestroyEvent&&(this.__onUserInteractionFinishedMillisecondDestroyEvent(),this.__onUserInteractionFinishedMillisecondDestroyEvent=null);var e={passive:!0,capture:!1};this.__element[0].removeEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&e),this.__elementCalendarTemplate[0].removeEventListener("mousedown",this.__mousedownCalendarHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&e),document.removeEventListener("mouseup",this.__mouseupHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&e)},i.prototype.destroy=function(){this.__intervalTimerCalendar&&(clearInterval(this.__intervalTimerCalendar),this.__intervalTimerCalendar=0),_.prototype.destroy.call(this)},i.prototype.__onMousedown=function(){var t=this;return function(e){t.getIsEnabled()&&w.Access.checkAccess(t,"operate")&&t.openDateTimePicker()}},i.prototype.__onMousedownCalendar=function(){var o=this;return function(e){if(o.getIsEnabled()&&w.Access.checkAccess(o,"operate")){var t=$(e.target);if(o.__isPressedCalendar=!0,t.hasClass("tchmi-date-time-picker-calendar-template-month-prev")){if(0==(n=o.__internalDateObject.month-1)){if(n=12,(i=o.__internalDateObject.year-1)<1970)return;o.__internalDateObject.year=i}o.__internalDateObject.month=n,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate(),o.__intervalTimerCalendar=setInterval(function(){if(o.__isPressedCalendar){var e=o.__internalDateObject.month-1;if(0===e){e=12;var t=o.__internalDateObject.year-1;if(t<1970)return;o.__internalDateObject.year=t}o.__internalDateObject.month=e,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate()}},400)}else if(t.hasClass("tchmi-date-time-picker-calendar-template-month-next")){var n;if(12<(n=o.__internalDateObject.month+1)){if(n=1,9999<(i=o.__internalDateObject.year+1))return;o.__internalDateObject.year=i}o.__internalDateObject.month=n,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate(),o.__intervalTimerCalendar=setInterval(function(){if(o.__isPressedCalendar){var e=o.__internalDateObject.month+1;if(12<e){e=1;var t=o.__internalDateObject.year+1;if(9999<t)return;o.__internalDateObject.year=t}o.__internalDateObject.month=e,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate()}},400)}else if(t.hasClass("tchmi-date-time-picker-calendar-template-year-prev"))1970<=(i=o.__internalDateObject.year-1)&&(o.__internalDateObject.year=i,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate(),o.__intervalTimerCalendar=setInterval(function(){if(o.__isPressedCalendar){var e=o.__internalDateObject.year-1;1970<=e&&(o.__internalDateObject.year=e,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate())}},400));else if(t.hasClass("tchmi-date-time-picker-calendar-template-year-next")){var i;(i=o.__internalDateObject.year+1)<=9999&&(o.__internalDateObject.year=i,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate(),o.__intervalTimerCalendar=setInterval(function(){if(o.__isPressedCalendar){var e=o.__internalDateObject.year+1;e<=9999&&(o.__internalDateObject.year=e,o.__elementCalendarTemplate.empty().append(o.createCalendar(o.__internalDateObject.year,o.__internalDateObject.month,o.__internalDateObject.day)),o.__updateHeaderDate())}},400))}else if(t.hasClass("tchmi-date-time-picker-calendar-template-day-element")){t.parent().children().removeClass("active"),t.addClass("active");var a=t[0].textContent;null!==a&&(o.__internalDateObject.day=parseInt(a,10),o.__updateHeaderDate())}}}},i.prototype.__onMousedownTimeButtons=function(){var x=this;return function(e){if(x.__isPressedTimeButtons=!0,-1!==e.name.search("hourUp")){if(void 0!==(v=x.__baseControls[x.__id+"_hourValue"])){var t=v;if(void 0!==(D=t.getText())){var n=D.trim();if(new RegExp("^-?[0-9]*$").test(n)){var i=parseInt(D,10);i<23&&(i++,t.setText(("00"+i).substring(Math.min((""+i).length,2))),i<=23&&0<=i&&(x.__internalDateObject.hour=i,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&(i=parseInt(t.getText(),10))<23&&(i++,t.setText(("00"+i).substring(Math.min((""+i).length,2))),i<=23&&0<=i&&(x.__internalDateObject.hour=i,x.__updateHeaderDate()))},150))}}}}else if(-1!==e.name.search("hourDown")){if(void 0!==(v=x.__baseControls[x.__id+"_hourValue"])){var a=v;if(void 0!==(D=a.getText())&&(n=D.trim(),new RegExp("^-?[0-9]*$").test(n))){var o=parseInt(D,10);0<o&&(o--,a.setText(("00"+o).substring(Math.min((""+o).length,2))),o<=23&&0<=o&&(x.__internalDateObject.hour=o,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&0<o&&(o=parseInt(a.getText(),10),o--,a.setText(("00"+o).substring(Math.min((""+o).length,2))),o<=23&&0<=o&&(x.__internalDateObject.hour=o,x.__updateHeaderDate()))},150))}}}else if(-1!==e.name.search("minuteUp")){if(void 0!==(v=x.__baseControls[x.__id+"_minuteValue"])){var r=v;if(void 0!==(D=r.getText())&&(n=D.trim(),new RegExp("^-?[0-9]*$").test(n))){var s=parseInt(D,10);s<59&&(s++,r.setText(("00"+s).substring(Math.min((""+s).length,2))),s<=59&&0<=s&&(x.__internalDateObject.minute=s,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&(s=parseInt(r.getText(),10))<59&&(s++,r.setText(("00"+s).substring(Math.min((""+s).length,2))),s<=59&&0<=s&&(x.__internalDateObject.minute=s,x.__updateHeaderDate()))},150))}}}else if(-1!==e.name.search("minuteDown")){if(void 0!==(v=x.__baseControls[x.__id+"_minuteValue"])){var l=v;if(void 0!==(D=l.getText())&&(n=D.trim(),new RegExp("^-?[0-9]*$").test(n))){var _=parseInt(D,10);0<_&&(_--,l.setText(("00"+_).substring(Math.min((""+_).length,2))),_<=59&&0<=_&&(x.__internalDateObject.minute=_,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&0<(_=parseInt(l.getText(),10))&&(_--,l.setText(("00"+_).substring(Math.min((""+_).length,2))),_<=59&&0<=_&&(x.__internalDateObject.minute=_,x.__updateHeaderDate()))},150))}}}else if(-1!==e.name.search("millisecondUp")){if(void 0!==(v=x.__baseControls[x.__id+"_millisecondValue"])){var d=v;if(void 0!==(D=d.getText())&&(n=D.trim(),new RegExp("^-?[0-9]*$").test(n))){var c=parseInt(D,10);c<999&&(0<=++c?d.setText(("000"+c).substring(Math.min((""+c).length,3))):d.setText(c.toString()),c<=999&&0<=c&&(x.__internalDateObject.millisecond=c,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&(c=parseInt(d.getText(),10))<999&&(0<=++c?d.setText(("000"+c).substring(Math.min((""+c).length,3))):d.setText(c.toString()),c<=999&&0<=c&&(x.__internalDateObject.millisecond=c,x.__updateHeaderDate()))},150))}}}else if(-1!==e.name.search("millisecondDown")){if(void 0!==(v=x.__baseControls[x.__id+"_millisecondValue"])){var m=v;if(void 0!==(D=m.getText())&&(n=D.trim(),new RegExp("^-?[0-9]*$").test(n))){var h=parseInt(D,10);0<h&&(h--,m.setText(("000"+h).substring(Math.min((""+h).length,3))),h<=999&&0<=h&&(x.__internalDateObject.millisecond=h,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&0<(h=parseInt(m.getText(),10))&&(h--,m.setText(("000"+h).substring(Math.min((""+h).length,3))),h<=999&&0<=h&&(x.__internalDateObject.millisecond=h,x.__updateHeaderDate()))},150))}}}else if(-1!==e.name.search("secondUp")){if(void 0!==(v=x.__baseControls[x.__id+"_secondValue"])){var u=v;if(void 0!==(D=u.getText())&&(n=D.trim(),new RegExp("^-?[0-9]*$").test(n))){var p=parseInt(D,10);p<59&&(p++,u.setText(("00"+p).substring(Math.min((""+p).length,2))),p<=59&&0<=p&&(x.__internalDateObject.second=p,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&(p=parseInt(u.getText(),10))<59&&(p++,u.setText(("00"+p).substring(Math.min((""+p).length,2))),p<=59&&0<=p&&(x.__internalDateObject.second=p,x.__updateHeaderDate()))},150))}}}else if(-1!==e.name.search("secondDown")){var v;if(void 0!==(v=x.__baseControls[x.__id+"_secondValue"])){var D,b=v;if(void 0!==(D=b.getText())&&(n=D.trim(),new RegExp("^-?[0-9]*$").test(n))){var T=parseInt(D,10);0<T&&(T--,b.setText(("00"+T).substring(Math.min((""+T).length,2))),T<=59&&0<=T&&(x.__internalDateObject.second=T,x.__updateHeaderDate()),x.__intervalTimerTimeButtons=setInterval(function(){x.__isPressedTimeButtons&&0<(T=parseInt(b.getText(),10))&&(T--,b.setText(("00"+T).substring(Math.min((""+T).length,2))),T<=59&&0<=T&&(x.__internalDateObject.second=T,x.__updateHeaderDate()))},150))}}}}},i.prototype.__updateHeaderDate=function(){var e=this.__baseControls[this.__id+"_dateValue"];if(void 0!==e){var t=this.__internalDateObject,n=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),i=new Date(n+this.__utcOffset),a=w.Localization.formatDate(i);e.setText(a)}},i.prototype.__onMouseup=function(){var t=this;return function(e){t.__isPressedTimeButtons=!1,null!==t.__intervalTimerTimeButtons&&clearInterval(t.__intervalTimerTimeButtons),t.__isPressedCalendar=!1,t.__intervalTimerCalendar&&(clearInterval(t.__intervalTimerCalendar),t.__intervalTimerCalendar=0)}},i.prototype.__onPressed=function(){var a=this;return function(e){if(-1!==e.name.search("ok")){var t=a.__internalDateObject,n=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),i=new Date(n+a.__utcOffset);a.setValue(i.toISOString(),!1),w.TopMostLayer.remove(a,a.__elementDTPTemplate)}else-1!==e.name.search("cancel")&&a.closeDateTimePicker()}},i.prototype.__onTextChanged=function(){var r=this;return function(e){if(-1!==e.name.search("hourValueTextbox")){if(void 0!==(n=r.__baseControls[r.__id+"_hourValue"])&&void 0!==(a=(i=n).getText())){var t=a.trim();new RegExp("^[0-9]*$").test(t)&&(""===t?0:parseInt(t,10))<=23?i.getElement().removeClass("tchmi-date-time-picker-time-template-textbox-error"):i.getElement().addClass("tchmi-date-time-picker-time-template-textbox-error")}}else if(-1!==e.name.search("minuteValueTextbox"))void 0!==(n=r.__baseControls[r.__id+"_minuteValue"])&&void 0!==(a=(i=n).getText())&&(t=a.trim(),new RegExp("^[0-9]*$").test(t)&&(""===t?0:parseInt(t,10))<=59?i.getElement().removeClass("tchmi-date-time-picker-time-template-textbox-error"):i.getElement().addClass("tchmi-date-time-picker-time-template-textbox-error"));else if(-1!==e.name.search("millisecondValueTextbox"))void 0!==(n=r.__baseControls[r.__id+"_millisecondValue"])&&void 0!==(a=(i=n).getText())&&(t=a.trim(),new RegExp("^[0-9]*$").test(t)&&(""===t?0:parseInt(t,10))<=999?i.getElement().removeClass("tchmi-date-time-picker-time-template-textbox-error"):i.getElement().addClass("tchmi-date-time-picker-time-template-textbox-error"));else if(-1!==e.name.search("secondValueTextbox")){var n,i,a;void 0!==(n=r.__baseControls[r.__id+"_secondValue"])&&void 0!==(a=(i=n).getText())&&(t=a.trim(),new RegExp("^[0-9]*$").test(t)&&(""===t?0:parseInt(t,10))<=59?i.getElement().removeClass("tchmi-date-time-picker-time-template-textbox-error"):i.getElement().addClass("tchmi-date-time-picker-time-template-textbox-error"))}var o=r.__baseControls[r.__id+"_okButton"];void 0!==o&&(0<r.__elementDTPTemplate.find(".tchmi-date-time-picker-time-template-textbox-error").length?o.setIsEnabled(!1):o.setIsEnabled(!0))}},i.prototype.__onUserInteractionFinished=function(){var r=this;return function(e){if(-1!==e.name.search("hourValueTextbox")){if(void 0!==(i=r.__baseControls[r.__id+"_hourValue"])&&void 0!==(o=(a=i).getText())){var t=o.trim();if(new RegExp("^[0-9]*$").test(t)){var n=void 0;(n=""===t?0:parseInt(t,10))<=23&&(a.setText(("00"+n).substring(Math.min((""+n).length,2))),r.__internalDateObject.hour=n,r.__updateHeaderDate())}}}else if(-1!==e.name.search("minuteValueTextbox"))void 0!==(i=r.__baseControls[r.__id+"_minuteValue"])&&void 0!==(o=(a=i).getText())&&(t=o.trim(),new RegExp("^[0-9]*$").test(t)&&(n=void 0,(n=""===t?0:parseInt(t,10))<=59&&(a.setText(("00"+n).substring(Math.min((""+n).length,2))),r.__internalDateObject.minute=n,r.__updateHeaderDate())));else if(-1!==e.name.search("millisecondValueTextbox"))void 0!==(i=r.__baseControls[r.__id+"_millisecondValue"])&&void 0!==(o=(a=i).getText())&&(t=o.trim(),new RegExp("^[0-9]*$").test(t)&&(n=void 0,(n=""===t?0:parseInt(t,10))<=999&&(a.setText(("000"+n).substring(Math.min((""+n).length,3))),r.__internalDateObject.millisecond=n,r.__updateHeaderDate())));else if(-1!==e.name.search("secondValueTextbox")){var i,a,o;void 0!==(i=r.__baseControls[r.__id+"_secondValue"])&&void 0!==(o=(a=i).getText())&&(t=o.trim(),new RegExp("^[0-9]*$").test(t)&&(n=void 0,(n=""===t?0:parseInt(t,10))<=59&&(a.setText(("00"+n).substring(Math.min((""+n).length,2))),r.__internalDateObject.second=n,r.__updateHeaderDate())))}}},i.prototype.openDateTimePicker=function(){var t=this;null===this.__elementDTPTemplate[0].parentElement&&w.TopMostLayer.add(this,this.__elementDTPTemplate,{centerHorizontal:!0,centerVertical:!0,removeCb:function(e){e.canceled&&(w.EventProvider.raise(t.__id+".onCancel"),t.__processValue())},resizeCb:function(e){t.__elementDTPTemplate.find(".tchmi-date-time-picker-time-area-template").css({"margin-top":"0px"}),t.__elementDTPTemplate.find(".tchmi-date-time-picker-button-area-template").css({top:"109px","margin-bottom":"0px"}),t.__elementDTPTemplate.find(".tchmi-date-time-picker-calendar-template").css({width:"350px"}),t.__elementDTPTemplate.find(".tchmi-date-time-picker-time-and-button-area-template").css({width:""}),0<t.__elementDTPTemplate.find(".tchmi-date-time-picker-time-and-button-area-template")[0].offsetTop&&(t.__elementDTPTemplate.find(".tchmi-date-time-picker-time-area-template").css({"margin-top":"10px"}),t.__elementDTPTemplate.find(".tchmi-date-time-picker-button-area-template").css({top:"10px","margin-bottom":"10px"}),t.__elementDTPTemplate.find(".tchmi-date-time-picker-calendar-template").css({width:"100%"}),t.__elementDTPTemplate.find(".tchmi-date-time-picker-time-and-button-area-template").css({width:"100%"}))}})},i.prototype.closeDateTimePicker=function(){null!==this.__elementDTPTemplate[0].parentElement&&(w.TopMostLayer.remove(this,this.__elementDTPTemplate),w.EventProvider.raise(this.__id+".onCancel"),this.__processValue())},i.prototype.createCalendar=function(e,t,n){var i=document.createDocumentFragment(),a=document.createElement("div");a.classList.add("tchmi-date-time-picker-calendar-template-calendar");var o=document.createElement("div");o.classList.add("tchmi-date-time-picker-calendar-template-header"),o.innerHTML='<ul class="tchmi-date-time-picker-calendar-template-header-month"><li class="tchmi-date-time-picker-calendar-template-prev tchmi-date-time-picker-calendar-template-month-prev">&lt; </li><li class="tchmi-date-time-picker-calendar-template-actuallMonth"> '+this.__monthNames[t-1]+' </li><li class="tchmi-date-time-picker-calendar-template-next tchmi-date-time-picker-calendar-template-month-next">&gt; </li></ul><ul class="tchmi-date-time-picker-calendar-template-header-year"><li class="tchmi-date-time-picker-calendar-template-prev tchmi-date-time-picker-calendar-template-year-prev" >&lt; </li><li class="tchmi-date-time-picker-calendar-template-actuallMonth"> '+e+' </li><li class="tchmi-date-time-picker-calendar-template-next tchmi-date-time-picker-calendar-template-year-next">&gt; </li></ul>',a.appendChild(o);var r=document.createElement("ul");r.classList.add("tchmi-date-time-picker-calendar-template-weekdays"),r.innerHTML="<li>Mo</li><li>Tu</li><li>We</li><li>Th</li><li>Fr</li><li>Sa</li><li>Su</li>",a.appendChild(r);var s=new Date(e,t,0).getDate(),l=new Date(e,t-1,1).getDay();l=0===l?7:l;var _=document.createElement("ul");_.classList.add("tchmi-date-time-picker-calendar-template-days");for(var d=-(l-1),c=s;d<c;d++){var m=document.createElement("li");0<=d&&(m.textContent=(d+1).toString(),m.classList.add("tchmi-date-time-picker-calendar-template-day-element")),d+1===n&&m.classList.add("active"),_.appendChild(m)}for(var h=l-1+s;!isNaN(h)&&h%7!=0;)m=document.createElement("li"),_.appendChild(m),h++;return a.appendChild(_),i.appendChild(a),i},i.prototype.createTime=function(e,t,n,i){var a=document.createDocumentFragment(),o=document.createElement("div");o.classList.add("tchmi-date-time-picker-time-template");var r=w.ControlFactory.createEx("tchmi-textblock",this.__id+"_timeLabel",{"data-tchmi-text-horizontal-alignment":"Center","data-tchmi-text-vertical-alignment":"Center","data-tchmi-text-font-size":15,"data-tchmi-text":"Time"},this);if(void 0===r)throw new Error("Needed Textblock could not be instantiated");r.getElement().addClass("tchmi-date-time-picker-template-time-label"),o.appendChild(r.getElement()[0]);var s=document.createElement("div");s.classList.add("tchmi-date-time-picker-time-template-hour");var l=w.ControlFactory.createEx("tchmi-button",this.__id+"_hourUpButton",{"data-tchmi-zindex":1},this);if(void 0===l)throw new Error("Needed Button could not be instantiated");l.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-up-button"),s.appendChild(l.getElement()[0]),this.__baseControls[this.__id+"_hourUpButton"]=l;var _=w.ControlFactory.createEx("tchmi-textbox",this.__id+"_hourValueTextbox",{"data-tchmi-text":("00"+e).slice(-2),"data-tchmi-text-horizontal-alignment":"Center","data-tchmi-box-shadow":[{blur:5,blurUnit:"px",color:{color:"rgba(0, 0, 0, 0.6)"},offsetX:0,offsetXUnit:"px",offsetY:0,offsetYUnit:"px",spread:0,spreadUnit:"px"}],"data-tchmi-auto-focus-out":!0},this);if(void 0===_)throw new Error("Needed Textbox could not be instantiated");_.getElement().addClass("tchmi-date-time-picker-time-template-textbox"),s.appendChild(_.getElement()[0]),this.__baseControls[this.__id+"_hourValue"]=_;var d=w.ControlFactory.createEx("tchmi-button",this.__id+"_hourDownButton",{},this);if(void 0===d)throw new Error("Needed Button could not be instantiated");d.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-down-button"),s.appendChild(d.getElement()[0]),this.__baseControls[this.__id+"_hourDownButton"]=d,o.appendChild(s);var c=document.createElement("div");c.classList.add("tchmi-date-time-picker-time-template-colon"),c.textContent=":",o.appendChild(c);var m=document.createElement("div");m.classList.add("tchmi-date-time-picker-time-template-minute");var h=w.ControlFactory.createEx("tchmi-button",this.__id+"_minuteUpButton",{"data-tchmi-zindex":1},this);if(void 0===h)throw new Error("Needed Button could not be instantiated");h.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-up-button"),m.appendChild(h.getElement()[0]),this.__baseControls[this.__id+"_minuteUpButton"]=h;var u=w.ControlFactory.createEx("tchmi-textbox",this.__id+"_minuteValueTextbox",{"data-tchmi-text":("00"+t).slice(-2),"data-tchmi-text-horizontal-alignment":"Center","data-tchmi-box-shadow":[{blur:5,blurUnit:"px",color:{color:"rgba(0, 0, 0, 0.6)"},offsetX:0,offsetXUnit:"px",offsetY:0,offsetYUnit:"px",spread:0,spreadUnit:"px"}],"data-tchmi-auto-focus-out":!0},this);if(void 0===u)throw new Error("Needed Textbox could not be instantiated");u.getElement().addClass("tchmi-date-time-picker-time-template-textbox"),m.appendChild(u.getElement()[0]),this.__baseControls[this.__id+"_minuteValue"]=u;var p=w.ControlFactory.createEx("tchmi-button",this.__id+"_minuteDownButton",{},this);if(void 0===p)throw new Error("Needed Button could not be instantiated");p.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-down-button"),m.appendChild(p.getElement()[0]),this.__baseControls[this.__id+"_minuteDownButton"]=p,o.appendChild(m);var v=document.createElement("div");v.classList.add("tchmi-date-time-picker-time-template-colon"),v.textContent=":",o.appendChild(v);var D=document.createElement("div");D.classList.add("tchmi-date-time-picker-time-template-second");var b=w.ControlFactory.createEx("tchmi-button",this.__id+"_secondUpButton",{"data-tchmi-zindex":1},this);if(void 0===b)throw new Error("Needed Button could not be instantiated");b.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-up-button"),D.appendChild(b.getElement()[0]),this.__baseControls[this.__id+"_secondUpButton"]=b;var T=w.ControlFactory.createEx("tchmi-textbox",this.__id+"_secondValueTextbox",{"data-tchmi-text":("00"+n).slice(-2),"data-tchmi-text-horizontal-alignment":"Center","data-tchmi-box-shadow":[{blur:5,blurUnit:"px",color:{color:"rgba(0, 0, 0, 0.6)"},offsetX:0,offsetXUnit:"px",offsetY:0,offsetYUnit:"px",spread:0,spreadUnit:"px"}],"data-tchmi-auto-focus-out":!0},this);if(void 0===T)throw new Error("Needed Textbox could not be instantiated");T.getElement().addClass("tchmi-date-time-picker-time-template-textbox"),D.appendChild(T.getElement()[0]),this.__baseControls[this.__id+"_secondValue"]=T;var x=w.ControlFactory.createEx("tchmi-button",this.__id+"_secondDownButton",{},this);if(void 0===x)throw new Error("Needed Button could not be instantiated");x.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-down-button"),D.appendChild(x.getElement()[0]),this.__baseControls[this.__id+"_secondDownButton"]=x,o.appendChild(D);var E=document.createElement("div");E.classList.add("tchmi-date-time-picker-time-template-colon"),E.textContent=".",o.appendChild(E);var C=document.createElement("div");C.classList.add("tchmi-date-time-picker-time-template-millisecond");var y=w.ControlFactory.createEx("tchmi-button",this.__id+"_millisecondUpButton",{"data-tchmi-zindex":1},this);if(void 0===y)throw new Error("Needed Button could not be instantiated");y.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-up-button"),C.appendChild(y.getElement()[0]),this.__baseControls[this.__id+"_millisecondUpButton"]=y;var g=w.ControlFactory.createEx("tchmi-textbox",this.__id+"_millisecondValueTextbox",{"data-tchmi-text":("000"+i).slice(-3),"data-tchmi-text-horizontal-alignment":"Center","data-tchmi-box-shadow":[{blur:5,blurUnit:"px",color:{color:"rgba(0, 0, 0, 0.6)"},offsetX:0,offsetXUnit:"px",offsetY:0,offsetYUnit:"px",spread:0,spreadUnit:"px"}],"data-tchmi-auto-focus-out":!0},this);if(void 0===g)throw new Error("Needed Textbox could not be instantiated");g.getElement().addClass("tchmi-date-time-picker-time-template-textbox"),C.appendChild(g.getElement()[0]),this.__baseControls[this.__id+"_millisecondValue"]=g;var f=w.ControlFactory.createEx("tchmi-button",this.__id+"_millisecondDownButton",{},this);if(void 0===f)throw new Error("Needed Button could not be instantiated");return f.getElement().addClass("tchmi-date-time-picker-time-template-button tchmi-date-time-picker-time-template-down-button"),C.appendChild(f.getElement()[0]),this.__baseControls[this.__id+"_millisecondDownButton"]=f,o.appendChild(C),a.appendChild(o),a},i.prototype.setValue=function(e,t){void 0===t&&(t=!0);var n=w.ValueConverter.toString(e);null===n&&(n=this.getAttributeDefaultValueInternal("Value")),n!==this.__value&&(this.__value=n,w.EventProvider.raise(this.__id+".onFunctionResultChanged",["getValue"]),w.EventProvider.raise(this.__id+".onValueChanged",this.__value),t&&this.__processValue())},i.prototype.getValue=function(){return this.__value},i.prototype.__processValue=function(){var e;e=this.__value?new Date(this.__value):new Date,this.__internalDateObject=w.Localization.parseDate(e);var t=Date.UTC(this.__internalDateObject.year,this.__internalDateObject.month-1,this.__internalDateObject.day,this.__internalDateObject.hour,this.__internalDateObject.minute,this.__internalDateObject.second,this.__internalDateObject.millisecond);this.__utcOffset=e.valueOf()-t;var n=this;n.__updateHeaderDate();var i=n.__baseControls[n.__id+"_hourValue"];void 0!==i&&i.setText(("00"+this.__internalDateObject.hour).slice(-2));var a=n.__baseControls[n.__id+"_minuteValue"];void 0!==a&&a.setText(("00"+this.__internalDateObject.minute).slice(-2));var o=n.__baseControls[n.__id+"_secondValue"];void 0!==o&&o.setText(("00"+this.__internalDateObject.second).slice(-2));var r=n.__baseControls[n.__id+"_millisecondValue"];void 0!==r&&r.setText(("000"+this.__internalDateObject.millisecond).slice(-3)),this.__elementCalendarTemplate.children().hasClass("tchmi-date-time-picker-calendar-template-calendar")&&this.__elementCalendarTemplate.empty().append(this.createCalendar(this.__internalDateObject.year,this.__internalDateObject.month,this.__internalDateObject.day))},i.prototype.__processIsEnabled=function(){_.prototype.__processIsEnabled.call(this),this.__isEnabled||null!==this.__elementDTPTemplate[0].parentElement&&(w.TopMostLayer.remove(this,this.__elementDTPTemplate),w.EventProvider.raise(this.__id+".onCancel"))},n=i,t.TcHmiDateTimePicker=n,e.register("tchmi-date-time-picker",w.Controls.Beckhoff.TcHmiDateTimePicker,"Beckhoff/TcHmiDateTimePicker/","Beckhoff/TcHmiDateTimePicker/Template.html")}(TcHmi=TcHmi||{});