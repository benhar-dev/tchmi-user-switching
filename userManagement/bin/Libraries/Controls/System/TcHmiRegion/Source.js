var TcHmi;!function(_){var t,s,i,e;function n(t,e,n){var o=i.call(this,t,e,n)||this;return o.__targetObject=null,o.__targetmarkup=null,o.__onContentResizedEventDestroyEvent=null,o.__onResizedEventDestroyEvent=null,o.__onContentChangedEventDestroyEvent=null,o.__onContentCreatedEventDestroyEvent=null,!(o.__onContentRemovedEventDestroyEvent=null)===TCHMI_ENABLE_DESIGNER_MODE&&(o.__onContentChangedEventDestroyEvent=_.EventProvider.register("System.onContentChanged",o.__onContentChanged()),o.__onContentCreatedEventDestroyEvent=_.EventProvider.register("System.onContentCreated",o.__onContentCreated()),o.__onContentRemovedEventDestroyEvent=_.EventProvider.register("System.onContentRemoved",o.__onContentRemoved())),o.__asyncWorkData["System.TcHmiRegion.contentResized"]=!1,o.__asyncWorkData["System.TcHmiRegion.controlResized"]=!1,o}t=_.Controls||(_.Controls={}),s=t.System||(t.System={}),i=_.Controls.System.TcHmiControl,__extends(n,i),n.prototype.__previnit=function(){if(this.__elementTemplateRoot=this.__element.find(".tchmi-region-template"),0===this.__elementTemplateRoot.length)throw new Error("Invalid Template.html");i.prototype.__previnit.call(this)},n.prototype.__init=function(){i.prototype.__init.call(this)},n.prototype.__attach=function(){var t=this;i.prototype.__attach.call(this),"None"!==this.__scaleMode&&this.__processScaleMode(),this.__onResizedEventDestroyEvent=_.EventProvider.register(this.__id+".onResized",function(){t.__asyncWorkData["System.TcHmiRegion.controlResized"]=!0,t.__requestAsyncWork()})},n.prototype.__detach=function(){i.prototype.__detach.call(this),null!==this.__onContentResizedEventDestroyEvent&&(this.__onContentResizedEventDestroyEvent(),this.__onContentResizedEventDestroyEvent=null),null!==this.__onResizedEventDestroyEvent&&(this.__onResizedEventDestroyEvent(),this.__onResizedEventDestroyEvent=null)},n.prototype.destroy=function(){_.Engineering.ErrorPane.remove("E_REGION["+this.getId()+"]_CONTENT_ALREADY_USED"),this.__xhr&&(this.__xhr.abort(),this.__xhr=void 0),!0===TCHMI_ENABLE_DESIGNER_MODE&&(null!==this.__onContentChangedEventDestroyEvent&&(this.__onContentChangedEventDestroyEvent(),this.__onContentChangedEventDestroyEvent=null),null!==this.__onContentCreatedEventDestroyEvent&&(this.__onContentCreatedEventDestroyEvent(),this.__onContentCreatedEventDestroyEvent=null),null!==this.__onContentRemovedEventDestroyEvent&&(this.__onContentRemovedEventDestroyEvent(),this.__onContentRemovedEventDestroyEvent=null)),i.prototype.destroy.call(this)},n.prototype.__doAsyncWork=function(){i.prototype.__doAsyncWork.call(this),this.__isAttached&&((this.__asyncWorkData["System.TcHmiRegion.controlResized"]||this.__asyncWorkData["System.TcHmiRegion.contentResized"])&&"None"!==this.__scaleMode&&this.__processScaleMode(),this.__asyncWorkData["System.TcHmiRegion.controlResized"]=!1,this.__asyncWorkData["System.TcHmiRegion.contentResized"]=!1)},n.prototype.__tryContentRefresh=function(t,e){null===this.__targetContent||tchmi_path(t)!==tchmi_path(this.__targetContent)||null!=e&&this.__targetmarkup===e||(null!=e?this.__processTargetContent(e):this.__processTargetContent())},n.prototype.__onContentChanged=function(){var n=this;return function(t,e){n.__tryContentRefresh(e.url,e.content)}},n.prototype.__onContentCreated=function(){var n=this;return function(t,e){n.__tryContentRefresh(e.url,null)}},n.prototype.__onContentRemoved=function(){var n=this;return function(t,e){n.__tryContentRefresh(e.url,null)}},n.prototype.__isRecursionSave=function(t){for(var e=this.__parent;null!==e;){if("tchmi-region"===e.getType()&&void 0!==e.getTargetContent&&tchmi_path(e.getTargetContent())===t)return e=null,!1;e=e.getParent()}return!0},n.prototype.setWidthMode=function(t){var e=_.ValueConverter.toSizeModeWithContent(t);null===e&&(e=this.getAttributeDefaultValueInternal("WidthMode")),e!==this.__widthMode&&(this.__widthMode=e,_.EventProvider.raise(this.__id+".onFunctionResultChanged",["getWidthMode"]),this.__processWidthMode())},n.prototype.__processWidth=function(t){if("Content"===this.getWidthMode()){var e="";if(null!==this.__targetObject){var n=this.__targetObject.__getContentWidth();null!==n&&(e=n+"px"),t&&this.__targetObject===t||"Content"!==this.__targetObject.getWidthMode()||this.__targetObject.__processWidth(this)}_.StyleProvider.setSimpleElementStyle(this.__element,"width",e)}i.prototype.__processWidth.call(this,t)},n.prototype.setHeightMode=function(t){var e=_.ValueConverter.toSizeModeWithContent(t);null===e&&(e=this.getAttributeDefaultValueInternal("HeightMode")),e!==this.__heightMode&&(this.__heightMode=e,_.EventProvider.raise(this.__id+".onFunctionResultChanged",["getHeightMode"]),this.__processHeightMode())},n.prototype.__processHeight=function(t){if("Content"===this.__heightMode&&(this.__intHeight=null)!==this.__targetObject){var e=this.__targetObject.__getContentHeight();null!==e&&(this.__intHeight=e+"px"),t&&this.__targetObject===t||"Content"!==this.__targetObject.getHeightMode()||this.__targetObject.__processHeight(this)}i.prototype.__processHeight.call(this,t)},n.prototype.__getContentWidth=function(){return"Content"!==this.getWidthMode()?i.prototype.__getContentWidth.call(this):"Collapsed"!==this.__visibility&&null!==this.__targetObject?this.__targetObject.__getContentWidth():null},n.prototype.__getContentHeight=function(){return"Content"!==this.getHeightMode()?i.prototype.__getContentHeight.call(this):"Collapsed"!==this.__visibility&&null!==this.__targetObject?this.__targetObject.__getContentHeight():null},n.prototype.setTargetContent=function(t){var e=_.ValueConverter.toString(t);null===e&&(e=this.getAttributeDefaultValueInternal("TargetContent")),(e=""===e?null:tchmi_path(e))!==this.__targetContent&&(this.__targetContent=e,_.EventProvider.raise(this.__id+".onFunctionResultChanged",["getTargetContent"]),this.__processTargetContent())},n.prototype.getTargetContent=function(){return this.__targetContent},n.prototype.__destroyTargetobjObject=function(t,e){null!==e&&(e(),e=null),null!==t&&!1===t.getIsDestroyed()&&t.destroy()},n.prototype.__processTargetContent=function(t){var e=this;if(void 0===t&&(t=null),_.Engineering.ErrorPane.remove("E_REGION["+this.getId()+"]_CONTENT_ALREADY_USED"),TCHMI_BENCHMARK_MODE&&_.EventProvider.raise("Benchmark.TcHmiRegion<"+this.__id+">.onTargetContentLoad",{targetContent:this.__targetContent}),this.__targetmarkup=null,void 0!==this.__targetContent&&null!==this.__targetContent||(this.__destroyTargetobjObject(this.__targetObject,this.__onContentResizedEventDestroyEvent),this.__targetObject=null,this.__onContentResizedEventDestroyEvent=null),this.__targetContent){var n=tchmi_path(this.__targetContent);!1===this.__isRecursionSave(n)&&_.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Loading content="+this.__targetContent+" was blocked to avoid recursion!");var o,i=this,r=tchmi_path(this.__targetContent);if(null!=(o=null!=t?t:_.System.Caches.partialMarkupCache.get(r)))this.__processTargetMarkup(o),o=void 0;else{this.__xhr&&this.__xhr.abort();var s=new XMLHttpRequest;(this.__xhr=s).open("GET",r+(TCHMI_ENABLE_DESIGNER_MODE?"?preventcache="+Math.random():"")),s.addEventListener("load",function(t){200===s.status?i.__processTargetMarkup(s.responseText):_.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+i.getId()+", Attribut=TargetContent] Loading "+r+" failed with error="+s.statusText+"."),e.__xhr=void 0}),s.addEventListener("error",function(t){_.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+i.getId()+", Attribut=TargetContent] Loading "+r+" failed with error="+s.statusText+"."),e.__xhr=void 0}),s.send()}}else TCHMI_BENCHMARK_MODE&&_.EventProvider.raise("Benchmark.TcHmiRegion<"+this.__id+">.onTargetContentLoaded",{targetContent:this.__targetContent})},n.prototype.__processTargetMarkup=function(t){var n=this;if(this.__targetContent){var e,o=$(t);if(o.length&&(e=_.Controls.get(o[0].id)),e){var i=e.getParent();if(i&&i!==this)return _.Engineering.ErrorPane.add("E_REGION["+this.getId()+"]_CONTENT_ALREADY_USED","[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Loading content="+this.__targetContent+" was blocked because it is already used in region with id="+i.getId()+".",_.Engineering.ErrorPane.MessageType.Error),void _.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Loading content="+this.__targetContent+" was blocked because it is already used in region with id="+i.getId()+".")}if(t&&(this.__targetmarkup=t),e?e.__setParent(this):t&&(o[0].setAttribute("data-tchmi-partial-url",tchmi_path(this.__targetContent)),e=_.System.Services.controlManager.compile(o,this)),e&&e.getType()!==s.TcHmiContent.__type)return this.__destroyTargetobjObject(this.__targetObject,this.__onContentResizedEventDestroyEvent),this.__targetObject=null,this.__onContentResizedEventDestroyEvent=null,_.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Wrong content type (not tchmi-content)."),void(TCHMI_BENCHMARK_MODE&&_.EventProvider.raise("Benchmark.TcHmiRegion<"+this.__id+">.onTargetContentLoaded",{targetContent:this.__targetContent}));var r=this.__targetObject;this.__targetObject=e||null,null!==this.__targetObject?(this.__element[0].scrollTop=0,this.__element[0].scrollLeft=0,this.__elementTemplateRoot.prepend(this.__targetObject.getElement()),_.EventProvider.register(this.__targetObject.getId()+".onAttached",function(t,e){t.destroy(),null!==r&&(n.__destroyTargetobjObject(r,null),n.__removeChild(r),r=null),null!==n.__targetObject&&("Content"===n.getWidthMode()&&n.__processWidth(),"Content"===n.getHeightMode()&&n.__processHeight()),TCHMI_BENCHMARK_MODE&&_.EventProvider.raise("Benchmark.TcHmiRegion<"+n.__id+">.onTargetContentLoaded",{targetContent:n.__targetContent})})):(this.__destroyTargetobjObject(r,this.__onContentResizedEventDestroyEvent),r=null,this.__onContentResizedEventDestroyEvent=null),_.EventProvider.raise(this.__id+".onTargetContentReplaced",this.__targetObject),null!==this.__onContentResizedEventDestroyEvent&&(this.__onContentResizedEventDestroyEvent(),this.__onContentResizedEventDestroyEvent=null),null!==this.__targetObject&&(this.__onContentResizedEventDestroyEvent=_.EventProvider.register(this.__targetObject.getId()+".onResized",function(){n.__asyncWorkData["System.TcHmiRegion.contentResized"]=!0,n.__requestAsyncWork()})),this.__processScrolling(),"None"!==this.__scaleMode&&this.__processScaleMode()}},n.prototype.setIsEnabled=function(t){i.prototype.setIsEnabled.call(this,t)},n.prototype.__processIsEnabled=function(){i.prototype.__processIsEnabled.call(this)},n.prototype.__processAccessConfig=function(){i.prototype.__processAccessConfig.call(this)},n.prototype.setScaleMode=function(t){var e=_.ValueConverter.toScaleModeString(t);null===e&&(e=this.getAttributeDefaultValueInternal("ScaleMode")),e!==this.__scaleMode&&(this.__scaleMode=e,_.EventProvider.raise(this.__id+".onFunctionResultChanged",["getScaleMode"]),this.__processScaleMode(),this.__processScrolling())},n.prototype.getScaleMode=function(){return this.__scaleMode},n.prototype.__processScaleMode=function(){if(null!==this.__targetObject){var t=this.__targetObject.getElement();switch(this.__scaleMode){case"ScaleToFit":var e=this.__element.width()/t.width(),n=this.__element.height()/t.height(),o=n<e?n:e;t.css({"-webkit-transform":"scale("+o+")",transform:"scale("+o+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"});break;case"ScaleToFitWidth":o=this.__element.width()/t.width(),t.css({"-webkit-transform":"scale("+o+")",transform:"scale("+o+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"});break;case"ScaleToFitHeight":o=this.__element.height()/t.height(),t.css({"-webkit-transform":"scale("+o+")",transform:"scale("+o+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"});break;case"ScaleToFill":e=this.__element.width()/t.width()*1,n=this.__element.height()/t.height()*1,t.css({"-webkit-transform":"scale("+e+","+n+")",transform:"scale("+e+","+n+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"});break;case"None":default:t.css({"-webkit-transform":"",transform:"","-webkit-transform-origin":"","transform-origin":""})}}},n.prototype.setScrolling=function(t){var e=_.ValueConverter.toString(t);if(null===e&&(e=this.getAttributeDefaultValueInternal("Scrolling")),e!==this.__scrolling){switch(e){case"Yes":case"Auto":this.__scrolling=e;break;default:this.__scrolling="No"}_.EventProvider.raise(this.__id+".onFunctionResultChanged",["getScrolling"]),this.__processScrolling()}},n.prototype.getScrolling=function(){return this.__scrolling},n.prototype.__processScrolling=function(){var t={};if("None"===this.__scaleMode||void 0===this.__scaleMode)switch(this.__scrolling){case"Yes":case"Auto":t["overflow-x"]="",t["overflow-y"]="";break;case"No":default:t["overflow-x"]="hidden",t["overflow-y"]="hidden"}else t["overflow-x"]="hidden",t["overflow-y"]="hidden";_.StyleProvider.setSimpleElementStyle(this.__elementTemplateRoot,t),this.__processWidth(),this.__processHeight()},e=n,s.TcHmiRegion=e,t.register("tchmi-region",_.Controls.System.TcHmiRegion,"System/TcHmiRegion/","System/TcHmiRegion/Template.html")}(TcHmi=TcHmi||{});